<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>One Punch Gacha: Online Leaderboard - Definitive Version</title>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* CSS VARIABLES & RESET */
        :root { 
            --gold: #ffd700; --red: #ff4757; --dark: #0a0a0a; --green: #2ecc71; 
            --purple: #a020f0; --blue: #3498db; --orange: #e67e22; --gray: #2d3436;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body { 
            margin: 0; background: var(--dark); color: #fff; 
            font-family: 'Poppins', sans-serif; height: 100vh; 
            display: flex; flex-direction: column; overflow: hidden; 
        }
        
        /* BACKGROUND ELEMENTS */
        #videoBg { 
            position: fixed; inset: 0; width: 100%; height: 100%; 
            object-fit: cover; z-index: -2; filter: brightness(0.2); 
            pointer-events: none; 
        }

        #flash-effect { 
            position: fixed; inset: 0; background: white; opacity: 0; 
            z-index: 10000; pointer-events: none; transition: 0.2s; 
        }

        /* LAYOUT & SCREENS */
        .header { 
            padding: 15px 20px; background: rgba(0,0,0,0.95); 
            border-bottom: 2px solid var(--gold); display: flex; 
            justify-content: space-between; align-items: center; 
            z-index: 100; backdrop-filter: blur(10px); 
        }

        .screen { 
            flex: 1; display: none; flex-direction: column; align-items: center; 
            padding: 20px; overflow-y: auto; padding-bottom: 120px; 
            z-index: 5; opacity: 0; transform: scale(0.98); transition: 0.3s ease;
        }

        .screen.active { display: flex; opacity: 1; transform: scale(1); }

        /* GACHA CARD STYLES */
        .rarity { 
            position: absolute; top: 8px; right: 8px; padding: 4px 10px; 
            border-radius: 6px; font-weight: bold; font-size: 0.8rem; 
            font-family: 'Bebas Neue'; z-index: 10; letter-spacing: 1px;
        }

        .LR { background: linear-gradient(45deg, #ff0000, #ffd700); color: #fff; box-shadow: 0 0 15px #f00; animation: glow-lr 1.5s infinite alternate; }
        .SSR { background: var(--gold); color: #000; box-shadow: 0 0 10px var(--gold); }
        .SR { background: var(--purple); color: #fff; }
        .R { background: var(--blue); color: #fff; }

        @keyframes glow-lr { from { box-shadow: 0 0 5px #f00; } to { box-shadow: 0 0 25px #ff0; } }
        
        .type-badge { 
            position: absolute; top: 8px; left: 8px; padding: 3px 8px; 
            border-radius: 4px; font-size: 0.6rem; font-weight: bold; 
            text-transform: uppercase; background: rgba(0,0,0,0.85); 
            border: 1px solid rgba(255,255,255,0.4); z-index: 10; 
        }

        .type-Physical { color: #ff4757; border-color: #ff4757; }
        .type-Energy { color: #3498db; border-color: #3498db; }
        .type-Tactics { color: #2ecc71; border-color: #2ecc71; }

        .card-item { 
            position: relative; aspect-ratio: 2/3; border-radius: 15px; 
            overflow: hidden; background-color: #1a1a1a; border: 1px solid #333;
            background-size: cover; background-position: center; transition: 0.3s;
        }

        /* INVENTORY & SHOP */
        #inv-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; width: 100%; }
        
        .pwr-tag { 
            position: absolute; bottom: 40px; width: 100%; background: rgba(0,0,0,0.8); 
            color: var(--gold); font-size: 0.6rem; text-align: center; font-weight: 600; padding: 3px 0;
        }

        .up-btn { 
            position: absolute; bottom: 0; width: 100%; height: 40px; 
            background: var(--green); border: none; color: #fff; font-family: 'Bebas Neue';
            font-size: 0.9rem; cursor: pointer;
        }

        /* ARENA BATTLE UI */
        .battle-container { width: 100%; background: rgba(0,0,0,0.85); border-radius: 20px; border: 2px solid #333; padding: 15px; margin-top: 15px; }
        .fighter-box { height: 160px; border: 2px solid #444; border-radius: 15px; position: relative; background-size: cover; background-position: center; }
        .hp-bar { width: 100%; height: 10px; background: #222; border-radius: 5px; margin-top: 8px; border: 1px solid #444; overflow: hidden; }
        .hp-fill { height: 100%; background: linear-gradient(90deg, #2ecc71, #27ae60); width: 100%; transition: 0.4s ease-out; }
        .battle-log { 
            width: 100%; height: 80px; background: #000; margin-top: 15px; border-radius: 10px; 
            padding: 10px; font-size: 0.75rem; color: #0f0; overflow-y: auto; font-family: monospace; border: 1px solid #333;
        }

        /* NAVIGATION */
        .nav { 
            position: fixed; bottom: 0; width: 100%; height: 80px; background: rgba(10,10,10,0.98); 
            display: flex; border-top: 2px solid #333; z-index: 1000; padding-bottom: env(safe-area-inset-bottom);
        }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #555; font-size: 0.7rem; }
        .nav-item.active { color: var(--gold); }
        .nav-item span { font-size: 1.6rem; margin-bottom: 2px; }

        .btn { 
            background: var(--red); color: white; border: none; padding: 15px; border-radius: 12px; 
            font-family: 'Bebas Neue'; font-size: 1.2rem; cursor: pointer; box-shadow: 0 5px 0 #900; active: transform: translateY(3px);
        }
        .btn:disabled { background: #555 !important; box-shadow: none !important; opacity: 0.6; cursor: not-allowed; }

        /* TIMER & SHOP UI */
        .shop-card { 
            width: 100%; background: linear-gradient(135deg, #1e1e1e, #111); border: 1px solid var(--gold);
            padding: 20px; border-radius: 15px; text-align: center; margin-bottom: 20px;
        }
        #daily-timer { font-weight: bold; font-size: 1.2rem; color: var(--gold); margin: 15px 0; font-family: monospace; }

    </style>
</head>
<body onclick="window.initGame()">

    <div id="flash-effect"></div>

    <div id="login-screen" style="position:fixed; inset:0; background:black; z-index:99999; display:flex; flex-direction:column; align-items:center; justify-content:center;">
        <h1 style="font-family:'Bebas Neue'; color:var(--gold); font-size:4rem;">ONE PUNCH GACHA</h1>
        <button class="btn" onclick="window.loginGoogle()" style="padding:15px 30px;">SIGN IN WITH GOOGLE</button>
    </div>

    <video id="videoBg" playsinline loop muted>
        <source src="https://raw.githubusercontent.com/mabarrra670-max/Sik/2618c2c289f712966754adcf30af376696ccc73f/lv_0_20260101162558.mp4" type="video/mp4">
    </video>

    <div class="header">
        <div>
            <b id="p-name" style="font-size:1.2rem; color:var(--gold);">PLAYER</b><br>
            <span id="p-id" class="id-pill" style="font-size:0.6rem; color:#888;">ID: ...</span>
        </div>
        <div class="diamond-pill" style="font-size:1.1rem; font-weight:bold; color:var(--gold);">üíé <span id="p-dia">0</span></div>
    </div>

    <div id="gacha" class="screen active">
        <h2 style="font-family:'Bebas Neue'; color:var(--gold); letter-spacing:2px;">HERO SUMMON</h2>
        <div style="background:rgba(255,215,0,0.15); padding:10px 25px; border-radius:25px; border:1px solid var(--gold); margin-bottom:20px;">
            <span style="font-weight:600; font-size:0.9rem;">PITY TO LR: <span id="pity-count" style="color:var(--red);">0</span>/50</span>
        </div>

        <div id="single-view" style="width:240px; height:340px; perspective:1000px; margin:10px 0;">
            <div id="card-box" style="width:100%; height:100%; position:relative; transform-style:preserve-3d; transition:transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
                <div style="position:absolute; width:100%; height:100%; backface-visibility:hidden; background:linear-gradient(45deg, #111, #222); border:2px solid #444; border-radius:15px; display:flex; align-items:center; justify-content:center; font-size:5rem; color:#333; font-family:'Bebas Neue';">?</div>
                <div id="card-img" style="position:absolute; width:100%; height:100%; backface-visibility:hidden; transform:rotateY(180deg); border-radius:15px; border:4px solid var(--gold); background-size:cover; background-position:center;">
                    <div id="g-rar" class="rarity"></div>
                    <div id="g-type" class="type-badge"></div>
                </div>
            </div>
        </div>

        <div id="multi-view" style="display:none; grid-template-columns:repeat(5,1fr); gap:10px; width:100%;"></div>

        <div style="display:flex; gap:15px; width:100%; margin-top:25px;">
            <button id="btn-p1" class="btn" style="flex:1" onclick="window.pull(1)">1x PULL (100 üíé)</button>
            <button id="btn-p10" class="btn" style="flex:1; background:linear-gradient(to bottom, #d4af37, #8b6508);" onclick="window.pull(10)">10x PULL (1k üíé)</button>
        </div>
    </div>

    <div id="shop" class="screen">
        <h2 style="font-family:'Bebas Neue'; color:var(--gold);">SUPPLY DEPOT</h2>
        <div class="shop-card">
            <h3>DAILY REWARDS</h3>
            <p style="font-size:0.8rem; color:#aaa;">Claim your daily bonus of 1,000 Diamonds!</p>
            <div id="daily-timer">00:00:00</div>
            <button id="daily-btn" class="btn" style="background:var(--green); box-shadow:0 5px 0 #1b5e20; width:80%;" onclick="window.claimDaily()">CLAIM NOW</button>
        </div>
    </div>

    <div id="pvp" class="screen">
        <h2 style="font-family:'Bebas Neue'; color:var(--gold);">HERO ARENA</h2>
        <div id="hero-select-list" style="display:flex; gap:12px; overflow-x:auto; width:100%; padding:10px 0; min-height:120px;"></div>
        
        <div class="battle-container">
            <div style="display:flex; justify-content:space-between; gap:15px;">
                <div style="flex:1">
                    <div id="p-fig" class="fighter-box"><div id="p-rar-b" class="rarity"></div><div id="p-typ-b" class="type-badge"></div></div>
                    <div class="hp-bar"><div id="p-hp" class="hp-fill"></div></div>
                </div>
                <div style="flex:1">
                    <div id="e-fig" class="fighter-box"><div id="e-rar-b" class="rarity"></div><div id="e-typ-b" class="type-badge"></div></div>
                    <div class="hp-bar"><div id="e-hp" class="hp-fill"></div></div>
                </div>
            </div>
            <div id="battle-log" class="battle-log">SYSTEM: Waiting for hero selection...</div>
            <button id="btn-fight" class="btn" style="width:100%; margin-top:15px; background:var(--orange); box-shadow:0 5px 0 #a67c00;" onclick="window.startBattle()" disabled>BATTLE START</button>
        </div>
    </div>

    <div id="leaderboard" class="screen"><h2 style="font-family:'Bebas Neue'; color:var(--gold);">TOP HEROES</h2><div id="rank-list" style="width:100%;"></div></div>
    <div id="profil" class="screen"><h2 style="font-family:'Bebas Neue'; color:var(--gold);">HERO COLLECTION</h2><div id="inv-grid"></div></div>

    <nav class="nav">
        <div class="nav-item active" onclick="window.nav('gacha', this)"><span>üõí</span>Summon</div>
        <div class="nav-item" onclick="window.nav('shop', this)"><span>üíé</span>Shop</div>
        <div class="nav-item" onclick="window.nav('pvp', this)"><span>‚öîÔ∏è</span>Arena</div>
        <div class="nav-item" onclick="window.nav('leaderboard', this)"><span>üèÜ</span>Rank</div>
        <div class="nav-item" onclick="window.nav('profil', this)"><span>üë§</span>Collection</div>
    </nav>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, doc, setDoc, collection, query, orderBy, limit, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // CONFIGURATION
        const firebaseConfig = { 
            apiKey: "AIzaSyAo3ztYZX8L9dK-K4dg6HZ7XuOJwp5JCTE", authDomain: "gachasaitama.firebaseapp.com", 
            projectId: "gachasaitama", storageBucket: "gachasaitama.firebasestorage.app", 
            messagingSenderId: "992321909458", appId: "1:992321909458:web:da0f8aa2c9b4e1c91f330b" 
        };
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db_fs = getFirestore(app);
        const provider = new GoogleAuthProvider();

        // MASTER HERO POOL (FIXED GAROU)
        const heroPool = [
            { id:1, name:"Saitama God", rar:"LR", rate:0.01, pwr:999999, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/saitamagod.png" },
            { id:2, name:"Cosmic Garou", rar:"LR", rate:0.09, pwr:65000, type:"Energy", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/cosmicgarou.png" },
            { id:3, name:"Saitama", rar:"SSR", rate:0.5, pwr:50000, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/saitama.png" },
            { id:4, name:"Tatsumaki", rar:"SSR", rate:1.0, pwr:42000, type:"Energy", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/tatsumaki.png" },
            { id:5, name:"Garou", rar:"SSR", rate:1.2, pwr:40000, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/garou.png" },
            { id:6, name:"Atomic Samurai", rar:"SSR", rate:1.5, pwr:32000, type:"Tactics", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/atomicsamurai.png" },
            { id:8, name:"Bang", rar:"SSR", rate:1.8, pwr:31000, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/bang.png" },
            { id:9, name:"Genos", rar:"SR", rate:5.0, pwr:22000, type:"Energy", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/genos.png" },
            { id:10, name:"Child Emperor", rar:"SR", rate:6.0, pwr:20000, type:"Tactics", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/childemperor.png" },
            { id:14, name:"Amai Mask", rar:"SR", rate:8.0, pwr:18000, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/amaimask.png" },
            { id:7, name:"Fubuki", rar:"SR", rate:10.0, pwr:15000, type:"Energy", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/fubuki.png" },
            { id:13, name:"Mumen Rider", rar:"R", rate:64.9, pwr:1000, type:"Physical", img:"https://raw.githubusercontent.com/mabarrra670-max/Gacha/main/card/mumenrider.png" }
        ];

        // AUDIO SYSTEM
        const sounds = {
            pull: new Audio('https://raw.githubusercontent.com/mabarrra670-max/Sik/main/pull.mp3'),
            reveal: new Audio('https://www.soundjay.com/buttons/sounds/button-10.mp3'),
            ssr: new Audio('https://www.soundjay.com/buttons/sounds/button-01.mp3')
        };

        let db = JSON.parse(localStorage.getItem('OPG_FINAL_VER')) || { name:"PLAYER", id: "OPG-TEMP", dia:5000, inv:[], selected:null, lastClaim:0, pity:0 };

        // MIGRATION & REPAIR
        db.inv = db.inv.map(item => {
            const m = heroPool.find(h => h.id === item.id);
            if(m) { item.type = m.type; item.img = m.img; }
            return item;
        });

        window.loginGoogle = () => signInWithPopup(auth, provider).catch(e => alert(e.message));
        onAuthStateChanged(auth, (user) => { if (user) { document.getElementById('login-screen').style.display='none'; db.name = user.displayName.split(' ')[0].toUpperCase(); db.uid = user.uid; db.id = "OPG-" + user.uid.substring(0,5); window.save(); } });

        window.save = async () => {
            localStorage.setItem('OPG_FINAL_VER', JSON.stringify(db));
            document.getElementById('p-dia').innerText = db.dia.toLocaleString();
            document.getElementById('p-name').innerText = db.name;
            document.getElementById('p-id').innerText = "ID: " + db.id;
            document.getElementById('pity-count').innerText = db.pity;
            if(db.uid) {
                let total = db.inv.reduce((s, h) => s + (h.pwr * Math.pow(h.lvl, 1.5)), 0);
                try { await setDoc(doc(db_fs, "leaderboard", db.uid), { name: db.name, pwr: Math.floor(total), id: db.id }); } catch(e) {}
            }
        };

        window.pull = (t) => {
            if(db.dia < t*100) return alert("Diamond Kurang!");
            db.dia -= t*100;
            sounds.pull.play();
            let res = [], hasSSR = false;
            for(let i=0; i<t; i++) {
                db.pity++;
                let rolled;
                if(db.pity >= 50) { rolled = heroPool[Math.floor(Math.random()*2)]; db.pity = 0; }
                else {
                    let r = Math.random()*100, cur=0;
                    for(let h of heroPool) { cur+=h.rate; if(r<=cur) { rolled=h; break; } }
                    if(!rolled) rolled = heroPool[heroPool.length-1];
                }
                if(rolled.rar === "LR") db.pity = 0;
                if(rolled.rar === "LR" || rolled.rar === "SSR") hasSSR = true;
                res.push(rolled);
                let o = db.inv.find(x => x.id === rolled.id);
                if(o) { o.dupes++; o.type = rolled.type; o.img = rolled.img; } else db.inv.push({...rolled, lvl:1, dupes:0});
            }

            const flash = document.getElementById('flash-effect');
            flash.style.background = hasSSR ? "gold" : "white"; flash.style.opacity = '1'; setTimeout(() => flash.style.opacity = '0', 250);
            window.save();

            if(t===1) {
                document.getElementById('multi-view').style.display='none';
                document.getElementById('single-view').style.display='block';
                const cardBox = document.getElementById('card-box');
                document.getElementById('card-img').style.backgroundImage = `url('${res[0].img}')`;
                document.getElementById('g-rar').className = `rarity ${res[0].rar}`; document.getElementById('g-rar').innerText = res[0].rar;
                document.getElementById('g-type').className = `type-badge type-${res[0].type}`; document.getElementById('g-type').innerText = res[0].type;
                cardBox.style.transform = "rotateY(180deg)";
                setTimeout(() => { sounds.reveal.play(); cardBox.style.transform = "rotateY(0deg)"; }, 1500);
            } else {
                document.getElementById('single-view').style.display='none';
                document.getElementById('multi-view').style.display='grid';
                document.getElementById('multi-view').innerHTML = res.map(h => `<div class="card-item"><div class="rarity ${h.rar}" style="font-size:0.5rem">${h.rar}</div><img src="${h.img}" style="width:100%;height:100%;object-fit:cover"></div>`).join('');
            }
        };

        window.startBattle = () => {
            if(!db.selected) return;
            document.getElementById('btn-fight').disabled = true;
            let log = document.getElementById('battle-log');
            log.innerHTML = "SYSTEM: Initializing battle...";
            
            let enemy = heroPool[Math.floor(Math.random()*heroPool.length)];
            document.getElementById('e-fig').style.backgroundImage = `url('${enemy.img}')`;
            document.getElementById('e-rar-b').className = `rarity ${enemy.rar}`; document.getElementById('e-rar-b').innerText = enemy.rar;
            document.getElementById('e-typ-b').className = `type-badge type-${enemy.type}`; document.getElementById('e-typ-b').innerText = enemy.type;

            let php = 100, ehp = 100;
            let pAtk = db.selected.pwr * Math.pow(db.selected.lvl, 1.5);
            let eAtk = enemy.pwr * (Math.random() * 2 + 0.5);

            const fight = setInterval(() => {
                let dmgToE = (pAtk / eAtk) * 10;
                let dmgToP = (eAtk / pAtk) * 10;
                ehp -= dmgToE; php -= dmgToP;
                
                log.innerHTML += `<br>ACTION: ${db.selected.name} deals ${Math.floor(dmgToE)} damage!`;
                log.scrollTop = log.scrollHeight;
                
                document.getElementById('p-hp').style.width = Math.max(0, php) + "%";
                document.getElementById('e-hp').style.width = Math.max(0, ehp) + "%";

                if(ehp <= 0 || php <= 0) {
                    clearInterval(fight);
                    if(ehp <= 0) { log.innerHTML += "<br>RESULT: VICTORY! +100 üíé"; db.dia += 100; }
                    else { log.innerHTML += "<br>RESULT: DEFEAT!"; }
                    window.save();
                    document.getElementById('btn-fight').disabled = false;
                }
            }, 1000);
        };

        window.claimDaily = () => {
            let now = Date.now();
            if(now - db.lastClaim >= 86400000) {
                db.dia += 1000; db.lastClaim = now; window.save();
                alert("SUCCESS: 1000 Diamonds received!");
            } else alert("ERROR: Claim not ready yet!");
        };

        function updateDailyTimer() {
            let timerEl = document.getElementById('daily-timer');
            let btn = document.getElementById('daily-btn');
            if(!timerEl) return;
            let rem = 86400000 - (Date.now() - db.lastClaim);
            if(rem > 0) {
                btn.disabled = true;
                let h = Math.floor(rem/3600000), m = Math.floor((rem%3600000)/60000), s = Math.floor((rem%60000)/1000);
                timerEl.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            } else {
                btn.disabled = false; timerEl.innerText = "READY TO CLAIM!";
            }
        }

        window.nav = async (id, el) => {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active'); el.classList.add('active');
            if(id === 'profil') {
                document.getElementById('inv-grid').innerHTML = db.inv.map(h => `
                    <div class="card-item" style="background-image:url('${h.img}')">
                        <div class="rarity ${h.rar}">${h.rar}</div>
                        <div class="pwr-tag">PWR: ${Math.floor(h.pwr * Math.pow(h.lvl, 1.5)).toLocaleString()}</div>
                        <button class="up-btn" onclick="window.up(${h.id})">LVL ${h.lvl} (UP: ${h.dupes}/5)</button>
                    </div>`).join('');
            }
            if(id === 'pvp') {
                document.getElementById('hero-select-list').innerHTML = db.inv.map(h => `<div onclick="window.prep(${h.id})" style="min-width:80px;height:110px;background-image:url('${h.img}');background-size:cover;border:2px solid #555;border-radius:10px;"></div>`).join('');
            }
            if(id === 'leaderboard') {
                const snap = await getDocs(query(collection(db_fs, "leaderboard"), orderBy("pwr", "desc"), limit(10)));
                let html = "", r = 1;
                snap.forEach(d => { let v = d.data(); html += `<div style="padding:15px; border-bottom:1px solid #333; display:flex; justify-content:space-between;"><span>${r}. ${v.name}</span><b style="color:var(--gold)">${v.pwr.toLocaleString()}</b></div>`; r++; });
                document.getElementById('rank-list').innerHTML = html;
            }
        };

        window.prep = (id) => {
            db.selected = db.inv.find(x => x.id === id);
            document.getElementById('p-fig').style.backgroundImage = `url('${db.selected.img}')`;
            document.getElementById('p-rar-b').className = `rarity ${db.selected.rar}`; document.getElementById('p-rar-b').innerText = db.selected.rar;
            document.getElementById('p-typ-b').className = `type-badge type-${db.selected.type}`; document.getElementById('p-typ-b').innerText = db.selected.type;
            document.getElementById('btn-fight').disabled = false;
        };

        window.up = (id) => { 
            let h = db.inv.find(x => x.id === id); 
            if(h.dupes >= 5) { h.dupes -= 5; h.lvl++; window.save(); window.nav('profil', document.querySelectorAll('.nav-item')[4]); } 
            else alert("Need 5 copies!"); 
        };

        window.initGame = () => { let v = document.getElementById('videoBg'); if(v) v.play().catch(()=>{}); };
        setInterval(updateDailyTimer, 1000);
        window.save();
    </script>
</body>
    </html>
